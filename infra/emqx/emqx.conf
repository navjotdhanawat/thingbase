## ============================================
## ThingBase EMQX Configuration
## ============================================
## Basic configuration. HTTP authentication is
## configured via environment variables at runtime.

## --------------------------------------------
## Node Settings
## --------------------------------------------
node {
  name = "emqx@127.0.0.1"
  data_dir = "/opt/emqx/data"
}

## --------------------------------------------
## Cluster Settings (Single Node for Railway)
## --------------------------------------------
cluster {
  discovery_strategy = static
}

## --------------------------------------------
## Dashboard Settings
## --------------------------------------------
dashboard {
  listeners {
    http {
      bind = "0.0.0.0:18083"
    }
  }
  default_username = "admin"
  default_password = "public"
}

## --------------------------------------------
## Listeners
## --------------------------------------------
listeners {
  tcp {
    default {
      bind = "0.0.0.0:1883"
      max_connections = 10000
    }
  }
  
  ws {
    default {
      bind = "0.0.0.0:8083"
      max_connections = 10000
    }
  }
}

## --------------------------------------------
## Logging
## --------------------------------------------
log {
  console {
    enable = true
    level = info
  }
}

## --------------------------------------------
## MQTT Settings
## --------------------------------------------
mqtt {
  max_packet_size = "1MB"
  max_clientid_len = 256
  max_topic_levels = 128
  max_qos_allowed = 2
  max_mqueue_len = 1000
  mqueue_default_priority = lowest
  keepalive_multiplier = 1.5
}

## --------------------------------------------
## Rate Limiting
## --------------------------------------------
limiter {
  bytes {
    rate = "infinity"
  }
  messages {
    rate = "infinity"
  }
  connection {
    rate = "1000/s"
  }
}
